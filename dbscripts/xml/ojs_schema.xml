<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE schema SYSTEM "dtd/xmlschema.dtd">

<!--
  * ojs_schema.xml
  *
  * Copyright (c) 2003-2004 The Public Knowledge Project
  * Distributed under the GNU GPL v2. For full terms see the file docs/COPYING.
  *
  * OJS database schema in XML.
  *
  * $Id$
  -->

<schema version="0.2">

	<!--
	  *
	  * TABLE version
	  *
	  -->
	<table name="versions">
		<descr>OJS installation and upgrade version history.</descr>
		<field name="major" type="I4">
			<KEY/>
			<DEFAULT value="0"/>
		</field>
		<field name="minor" type="I4">
			<KEY/>
			<DEFAULT value="0"/>
		</field>
		<field name="revision" type="I4">
			<KEY/>
			<DEFAULT value="0"/>
		</field>
		<field name="build" type="I4">
			<KEY/>
			<DEFAULT value="0"/>
		</field>
		<field name="date_installed" type="T">
			<NOTNULL/>
		</field>
		<field name="current" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
	</table>

	<!--
	  *
	  * TABLE site
	  *
	  -->
	<table name="site">
		<descr>Common site settings.</descr>
		<field name="title" type="C2" size="120">
			<KEY/>
			<DEFAULT value="Open Journal Systems"/>
		</field>
		<field name="intro" type="X"/>
		<field name="journal_redirect" type="I8">
			<descr>If not 0, redirect to the specified journal site.</descr>
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="about" type="X"/>
		<field name="contact_name" type="C2" size="90"/>
		<field name="contact_email" type="C2" size="90"/>
		<field name="min_password_length" type="I1">
			<NOTNULL/>
			<DEFAULT value="6"/>
		</field>
		<field name="locale" type="C2" size="5">
			<descr>Primary locale for the site.</descr>
			<NOTNULL/>
			<DEFAULT value="en_US"/>
		</field>
		<field name="installed_locales" type="C2" size="255">
			<descr>Locales for which support has been installed.</descr>
			<NOTNULL/>
			<DEFAULT value="en_US"/>
		</field>
		<field name="supported_locales" type="C2" size="255">
			<descr>Locales supported by the site (for hosted journals).</descr>
		</field>
		<field name="profile_locales" type="L">
			<descr>Allow users to select their working languages in their user profile.</descr>
			<NOTNULL/>
			<DEFAULT VALUE="0"/>
		</field>
	</table>
	
	<!--
	  *
	  * TABLE scheduled_tasks
	  *
	  -->
	<table name="scheduled_tasks">
		<descr>The last run times of all scheduled tasks.</descr>
		<field name="class_name" type="C2" size="255">
			<KEY/>
		</field>
		<field name="last_run" type="T">
			<NOTNULL/>
		</field>
	</table>

	<!--
	  *
	  * TABLE users
	  *
	  -->
	<table name="users">
		<descr>User authentication credentials and profile data.</descr>
		<field name="user_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="username" type="C2" size="32">
			<NOTNULL/>
		</field>
		<field name="password" type="C2" size="40">
			<NOTNULL/>
		</field>
		<field name="first_name" type="C2" size="40">
			<NOTNULL/>
		</field>
		<field name="middle_name" type="C2" size="40"/>
		<field name="last_name" type="C2" size="90">
			<NOTNULL/>
		</field>
		<field name="initials" type="C2" size="5"/>
		<field name="affiliation" type="C2" size="255"/>
		<field name="email" type="C2" size="90">
			<NOTNULL/>
		</field>
		<field name="phone" type="C2" size="24"/>
		<field name="fax" type="C2" size="24"/>
		<field name="mailing_address" type="C2" size="255"/>
		<field name="biography" type="X"/>
		<field name="interests" type="C2" size="255"/>
		<field name="locales" type="C2" size="255"/>
		<field name="date_registered" type="T">
			<NOTNULL/>
		</field>
		<field name="date_last_login" type="T">
			<NOTNULL/>
		</field>
		<field name="must_change_password" type="L"/>
		<index name="users_username">
			<col>username</col>
			<UNIQUE/>
		</index>
		<index name="users_email">
			<col>email</col>
			<UNIQUE/>
		</index>
	</table>

	<!--
	  *
	  * TABLE sessions
	  *
	  -->
	<table name="sessions">
		<descr>Browser/user sessions and session data.</descr>
		<field name="session_id" type="C2" size="32">
			<KEY/>
		</field>
		<field name="user_id" type="I8"/>
		<field name="ip_address" type="C2" size="15">
			<NOTNULL/>
		</field>
		<field name="user_agent" type="C2" size="255"/>
		<field name="created" type="I8">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="last_used" type="I8">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="remember" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="data" type="X">
			<NOTNULL/>
			<DEFAULT value=""/>
		</field>
		<index name="sessions_user_id">
			<col>user_id</col>
		</index>
	</table>

	<!--
	  *
	  * TABLE journals
	  *
	  -->
	<table name="journals">
		<descr>Journals and basic journal settings.</descr>
		<field name="journal_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="title" type="C2" size="255">
			<NOTNULL/>
		</field>
		<field name="description" type="X"/>
		<field name="path" type="C2" size="32">
			<NOTNULL/>
		</field>
		<field name="seq" type="F">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="enabled" type="L">
			<NOTNULL/>
			<DEFAULT value="1"/>
		</field>
		<index name="journals_path">
			<col>path</col>
			<UNIQUE/>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE journal_settings
	  *
	  -->
	<table name="journal_settings">
		<descr>Journal settings.</descr>
		<field name="journal_id" type="I8">
			<KEY/>
		</field>
		<field name="setting_name" type="C2" size="255">
			<KEY/>
		</field>
		<field name="setting_value" type="X"/>
		<field name="setting_type" type="C2" size="6">
			<descr>(bool|int|float|string|object)</descr>
			<NOTNULL/>
		</field>
		<index name="journal_settings_journal_id">
			<col>journal_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE roles
	  *
	  -->
	<table name="roles">
		<descr>User roles in journals.</descr>
		<field name="journal_id" type="I8">
			<KEY/>
		</field>
		<field name="user_id" type="I8">
			<KEY/>
		</field>
		<field name="role_id" type="I8">
			<KEY/>
		</field>
		<index name="roles_journal_id">
			<col>journal_id</col>
		</index>
		<index name="roles_user_id">
			<col>user_id</col>
		</index>
		<index name="roles_role_id">
			<col>role_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE sections
	  *
	  -->
	<table name="sections">
		<descr>Journal sections.</descr>
		<field name="section_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="journal_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="title" type="C2" size="120">
			<NOTNULL/>
		</field>
		<field name="abbrev" type="C2" size="20"/>
		<field name="seq" type="F">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="meta_indexed" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="author_indexed" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="rst" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="policy" type="X"/>
		<index name="sections_journal_id">
			<col>journal_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE section_editors
	  *
	  -->
	<table name="section_editors">
		<descr>Assignments of section editors to sections.</descr>
		<field name="journal_id" type="I8">
			<KEY/>
		</field>
		<field name="section_id" type="I8">
			<KEY/>
		</field>
		<field name="user_id" type="I8">
			<KEY/>
		</field>
		<index name="section_editors_journal_id">
			<col>journal_id</col>
		</index>
		<index name="section_editors_section_id">
			<col>section_id</col>
		</index>
		<index name="section_editors_user_id">
			<col>user_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE issues
	  *
	  -->
	<table name="issues">
		<descr>Journal issues.</descr>
		<field name="issue_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="journal_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="title" type="C2" size="120"/>
		<field name="volume" type="I2"/>
		<field name="number" type="I2"/>
		<field name="year" type="I2"/>
		<field name="published" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="current" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="date_published" type="T"/>
		<field name="access_status" type="L">
			<NOTNULL/>
			<DEFAULT value="1"/>
		</field>
		<field name="open_access_date" type="T"/>
		<field name="description" type="X"/>
		<field name="public_issue_id" type="C2" size="255"/>
		<field name="label_format" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="file_name" type="C2" size="90"/>
		<field name="original_file_name" type="C2" size="255"/>
		<field name="cover_page_description" type="X"/>
		<field name="show_cover_page" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<index name="issues_journal_id">
			<col>journal_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE articles
	  *
	  -->
	<table name="articles">
		<descr>Journal articles.</descr>
		<field name="article_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="user_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="journal_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="section_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="title" type="C2" size="255">
			<NOTNULL/>
		</field>
		<field name="title_alt1" type="C2" size="255"/>
		<field name="title_alt2" type="C2" size="255"/>
		<field name="abstract" type="X"/>
		<field name="abstract_alt1" type="X"/>
		<field name="abstract_alt2" type="X"/>
		<field name="discipline" type="C2" size="255"/>
		<field name="subject_class" type="C2" size="255"/>
		<field name="subject" type="C2" size="255"/>
		<field name="coverage_geo" type="C2" size="255"/>
		<field name="coverage_chron" type="C2" size="255"/>
		<field name="coverage_sample" type="C2" size="255"/>
		<field name="type" type="C2" size="255"/>
		<field name="language" type="C2" size="10">
			<DEFAULT value="en"/>
		</field>
		<field name="sponsor" type="C2" size="255"/>
		<field name="comments_to_ed" type="X"/>
		<field name="date_submitted" type="T"/>
		<field name="last_modified" type="T"/>
		<field name="date_status_modified" type="T"/>
		<field name="status" type="I1">
			<NOTNULL/>
			<DEFAULT value="1"/>
		</field>
		<field name="submission_progress" type="I1">
			<NOTNULL/>
			<DEFAULT value="1"/>
		</field>
		<field name="current_round" type="I1">
			<NOTNULL/>
			<DEFAULT value="1"/>
		</field>
		<field name="submission_file_id" type="I8"/>
		<field name="revised_file_id" type="I8"/>
		<field name="review_file_id" type="I8"/>
		<field name="editor_file_id" type="I8"/>
		<field name="copyedit_file_id" type="I8"/>
		<field name="public_article_id" type="C2" size="255"/>
		<field name="pages" type="C2" size="255"/>
		<index name="articles_user_id">
			<col>user_id</col>
		</index>
		<index name="articles_journal_id">
			<col>journal_id</col>
		</index>
		<index name="articles_section_id">
			<col>section_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE published_articles
	  *
	  -->
	<table name="published_articles">
		<descr>Journal articles.</descr>
		<field name="pub_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="issue_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="section_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="date_published" type="T">
			<NOTNULL/>
		</field>
		<field name="seq" type="F">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="views" type="I4">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="access_status" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<index name="published_articles_article_id">
			<col>article_id</col>
			<UNIQUE/>
		</index>
		<index name="published_articles_journal_id">
			<col>journal_id</col>
		</index>
		<index name="published_articles_issue_id">
			<col>issue_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE article_authors
	  *
	  -->
	<table name="article_authors">
		<descr>Author metadata for articles.</descr>
		<field name="author_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="article_id" type="I8">
			<NOTNLL/>
		</field>
		<field name="first_name" type="C2" size="40">
			<NOTNULL/>
		</field>
		<field name="middle_name" type="C2" size="40"/>
		<field name="last_name" type="C2" size="90">
			<NOTNULL/>
		</field>
		<field name="affiliation" type="C2" size="255"/>
		<field name="email" type="C2" size="90">
			<NOTNULL/>
		</field>
		<field name="biography" type="X"/>
		<field name="primary_contact" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="seq" type="F">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<index name="article_authors_article_id">
			<col>article_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE article_files
	  *
	  -->
	<table name="article_files">
		<descr>Files associated with articles. Includes submission files, supplementary files, etc.</descr>
		<field name="file_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="revision" type="I8">
			<KEY/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="file_name" type="C2" size="90">
			<NOTNULL/>
		</field>
		<field name="file_type" type="C2" size="255">
			<NOTNULL/>
		</field>
		<field name="file_size" type="I8">
			<NOTNULL/>
		</field>
		<field name="original_file_name" type="C2" size="90"/>
		<field name="type" type="C2" size="40">
			<NOTNULL/>
		</field>
		<field name="status" type="C2" size="40">
			<NOTNULL/>
		</field>
		<field name="viewable" type="L" />
		<field name="date_uploaded" type="T">
			<NOTNULL/>
		</field>
		<field name="date_modified" type="T">
			<NOTNULL/>
		</field>
		<field name="round" type="I1">
			<NOTNULL/>
		</field>
		<index name="article_files_article_id">
			<col>article_id</col>
		</index>
	</table>
	
	<table name="article_supplementary_files">
		<descr>Supplementary files attached to articles.</descr>
		<field name="supp_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="file_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="title" type="C2" size="255"/>
		<field name="creator" type="C2" size="255"/>
		<field name="subject" type="C2" size="255"/>
		<field name="type" type="C2" size="255"/>
		<field name="type_other" type="C2" size="255"/>
		<field name="description" type="X"/>
		<field name="publisher" type="C2" size="255"/>
		<field name="sponsor" type="C2" size="255"/>
		<field name="date_created" type="D"/>
		<field name="source" type="C2" size="255"/>
		<field name="language" type="C2" size="10">
			<DEFAULT value="en"/>
		</field>
		<field name="show_reviewers" type="L">
			<DEFAULT value="0"/>
		</field>
		<field name="date_submitted" type="T">
			<NOTNULL/>
		</field>
		<field name="seq" type="F">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<index name="article_supplementary_files_file_id">
			<col>file_id</col>
		</index>
		<index name="article_supplementary_files_article_id">
			<col>article_id</col>
		</index>
	</table>

	<!--
	  *
	  * TABLE article_notes
	  *
	  -->
	<table name="article_notes">
		<descr>Article submission notes added by editors to each submission</descr>
		<field name="note_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="user_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="date_created" type="T">
			<NOTNULL/>
		</field>
		<field name="date_modified" type="T">
			<NOTNULL/>
		</field>
		<field name="title" type="C2" size="255">
			<NOTNULL/>
		</field>
		<field name="note" type="X"/>
		<field name="file_id" type="I8">
			<NOTNULL/>
		</field>
		<index name="article_notes_article_id">
			<col>article_id</col>
		</index>
		<index name="article_notes_user_id">
			<col>user_id</col>
		</index>
		<index name="article_notes_file_id">
			<col>file_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE edit_assignments
	  *
	  -->
	<table name="edit_assignments">
		<descr>Editing assignments.</descr>
		<field name="edit_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="editor_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="date_notified" type="T"/>
		<field name="date_completed" type="T"/>
		<field name="date_acknowledged" type="T"/>
		<index name="edit_assignments_article_id">
			<col>article_id</col>
		</index>
		<index name="edit_assignments_editor_id">
			<col>editor_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE edit_decisions
	  *
	  -->
	<table name="edit_decisions">
		<descr>Editor decisions.</descr>
		<field name="edit_decision_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="round" type="I1">
			<NOTNULL/>
		</field>
		<field name="editor_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="decision" type="I1">
			<NOTNULL/>
		</field>
		<field name="date_decided" type="T">
			<NOTNULL/>
		</field>
		<index name="edit_decisions_article_id">
			<col>article_id</col>
		</index>
		<index name="edit_decisions_editor_id">
			<col>editor_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE review_rounds
	  *
	  -->
	<table name="review_rounds">
		<descr>Review rounds.</descr>
		<field name="article_id" type="I8">
			<KEY/>
		</field>
		<field name="round" type="I1">
			<KEY/>
		</field>
		<field name="review_revision" type="I8" />
		<index name="review_rounds_article_id">
			<col>article_id</col>
		</index>
	</table>		
		
	<!--
	  *
	  * TABLE review_assignments
	  *
	  -->
	<table name="review_assignments">
		<descr>Reviewing assignments.</descr>
		<field name="review_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="reviewer_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="comments" type="X"/>
		<field name="recommendation" type="I1"/>
		<field name="date_assigned" type="T"/>
		<field name="date_notified" type="T"/>
		<field name="date_confirmed" type="T"/>
		<field name="date_completed" type="T"/>
		<field name="date_acknowledged" type="T"/>
		<field name="date_due" type="T"/>
		<field name="last_modified" type="T"/>
		<field name="reminder_was_automatic" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="declined" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="replaced" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="cancelled" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="reviewer_file_id" type="I8"/>
		<field name="date_rated" type="T"/>
		<field name="date_reminded" type="T"/>
		<field name="timeliness" type="I1"/>
		<field name="quality" type="I1"/>
		<field name="round" type="I1">
			<NOTNULL/>
			<DEFAULT value="1"/>
		</field>
		<index name="review_assignments_article_id">
			<col>article_id</col>
		</index>
		<index name="review_assignments_reviewer_id">
			<col>reviewer_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE copyed_assignments
	  *
	  -->
	<table name="copyed_assignments">
		<descr>Copyediting assignments.</descr>
		<field name="copyed_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="copyeditor_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="copyedit_revision" type="I8"/>
		<field name="comments" type="X"/>
		<field name="date_notified" type="T"/>
		<field name="date_underway" type="T"/>
		<field name="date_completed" type="T"/>
		<field name="date_acknowledged" type="T"/>
		<field name="date_author_notified" type="T"/>
		<field name="date_author_underway" type="T"/>
		<field name="date_author_completed" type="T"/>
		<field name="date_author_acknowledged" type="T"/>
		<field name="date_final_notified" type="T"/>
		<field name="date_final_underway" type="T"/>
		<field name="date_final_completed" type="T"/>
		<field name="date_final_acknowledged" type="T"/>
		<field name="initial_revision" type="I8"/>
		<field name="editor_author_revision" type="I8"/>
		<field name="final_revision" type="I8"/>
		<index name="copyed_assignments_article_id">
			<col>article_id</col>
		</index>
		<index name="copyed_assignments_copyeditor_id">
			<col>copyeditor_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE layouted_assignments
	  *
	  -->
	<table name="layouted_assignments">
		<descr>Layout editing assignments.</descr>
		<field name="layouted_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="editor_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="date_notified" type="T"/>
		<field name="date_underway" type="T"/>
		<field name="date_completed" type="T"/>
		<field name="date_acknowledged" type="T"/>
		<field name="layout_file_id" type="I8"/>
		<index name="layouted_assignments_article_id">
			<col>article_id</col>
			<UNIQUE/>
		</index>
		<index name="layouted_assignments_editor_id">
			<col>editor_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE article_galleys
	  *
	  -->
	<table name="article_galleys">
		<descr>Article galleys.</descr>
		<field name="galley_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="file_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="label" type="C2" size="32"/>
		<field name="html_galley" type="L">
			<NOTULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="style_file_id" type="I8"/>
		<field name="seq" type="F">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<index name="article_galleys_article_id">
			<col>article_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE article_html_galley_images
	  *
	  -->
	<table name="article_html_galley_images">
		<descr>Images associated with an article HTML galley.</descr>
		<field name="galley_id" type="I8">
			<KEY/>
		</field>
		<field name="file_id" type="I8">
			<KEY/>
		</field>
	</table>
	
	<!--
	  *
	  * TABLE proof_assignments
	  *
	  -->
	<table name="proof_assignments">
		<descr>Proofreading assignments.</descr>
		<field name="proof_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="proofreader_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="date_scheduling_queue" type="T"/>
		<field name="author_comments" type="X"/>
		<field name="date_author_notified" type="T"/>
		<field name="date_author_underway" type="T"/>
		<field name="date_author_completed" type="T"/>
		<field name="date_author_acknowledged" type="T"/>
		<field name="proofreader_comments" type="X"/>
		<field name="date_proofreader_notified" type="T"/>
		<field name="date_proofreader_underway" type="T"/>
		<field name="date_proofreader_completed" type="T"/>
		<field name="date_proofreader_acknowledged" type="T"/>
		<field name="layouteditor_comments" type="X"/>
		<field name="date_layouteditor_notified" type="T"/>
		<field name="date_layouteditor_underway" type="T"/>
		<field name="date_layouteditor_completed" type="T"/>
		<field name="date_layouteditor_acknowledged" type="T"/>

		<index name="proof_assignments_article_id">
			<col>article_id</col>
		</index>
		<index name="proof_assignments_proofreader_id">
			<col>proofreader_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE article_event_log
	  *
	  -->
	<table name="article_event_log">
		<descr>A log of all events associated with a submission.</descr>
		<field name="log_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="user_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="date_logged" type="T">
			<NOTNULL/>
		</field>
		<field name="ip_address" type="C2" size="15">
			<NOTNULL/>
		</field>
		<field name="log_level" type="C2" size="1"/>
		<field name="event_type" type="I8"/>
		<field name="assoc_type" type="I8"/>
		<field name="assoc_id" type="I8"/>
		<field name="message" type="X"/>
		<index name="article_event_log_article_id">
			<col>article_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE article_email_log
	  *
	  -->
	<table name="article_email_log">
		<descr>A log of all emails sent out related to a submission.</descr>
		<field name="log_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="sender_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="date_sent" type="T">
			<NOTNULL/>
		</field>
		<field name="ip_address" type="C2" size="15">
			<NOTNULL/>
		</field>
		<field name="event_type" type="I8"/>
		<field name="assoc_type" type="I8"/>
		<field name="assoc_id" type="I8"/>
		<field name="from_address" type="C2" size="255"/>
		<field name="recipients" type="X"/>
		<field name="cc_recipients" type="X"/>
		<field name="bcc_recipients" type="X"/>
		<field name="subject" type="C2" size="255"/>
		<field name="body" type="X"/>
		<index name="article_email_log_article_id">
			<col>article_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE article_comments
	  *
	  -->
	<table name="article_comments">
		<descr>Comments posted on articles.</descr>
		<field name="comment_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="comment_type" type="I8"/>
		<field name="role_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="article_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="assoc_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="author_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="comment_title" type="C2" size="90">
			<NOTNULL/>
		</field>
		<field name="comments" type="X"/>
		<field name="date_posted" type="T"/>
		<field name="date_modified" type="T"/>
		<field name="viewable" type="L" />
		<index name="article_comments_article_id">
			<col>article_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE email_templates_default
	  *
	  -->
	<table name="email_templates_default">
		<descr>Default journal email templates.</descr>
		<field name="email_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="email_key" type="C2" size="30">
			<descr>Unique identifier for this email.</descr>
			<NOTNULL/>
		</field>
		<field name="can_disable" type="L">
			<NOTNULL/>
			<DEFAULT value="1"/>
		</field>
		<field name="can_edit" type="L">
			<NOTNULL/>
			<DEFAULT value="1"/>
		</field>
		<index name="email_templates_default_email_key">
			<col>email_key</col>
			<UNIQUE/>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE email_templates_default_data
	  *
	  -->
	<table name="email_templates_default_data">
		<descr>Default data for journal email templates.</descr>
		<field name="email_key" type="C2" size="30">
			<descr>Unique identifier for this email.</descr>
			<KEY/>
		</field>
		<field name="locale" type="C2" size="5">
			<KEY/>
			<DEFAULT value="en_US"/>
		</field>
		<field name="subject" type="C2" size="120">
			<NOTNULL/>
		</field>
		<field name="body" type="X"/>
	</table>
	
	<!--
	  *
	  * TABLE email_templates
	  *
	  -->
	<table name="email_templates">
		<descr>Templates for journal emails.</descr>
		<field name="email_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="email_key" type="C2" size="30">
			<descr>Unique identifier for this email.</descr>
			<NOTNULL/>
		</field>
		<field name="journal_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="enabled" type="L">
			<NOTNULL/>
			<DEFAULT value="1"/>
		</field>
		<index name="email_templates_email_key">
			<col>email_key</col>
			<col>journal_id</col>
			<UNIQUE/>
		</index>
		<index name="email_templates_journal_id">
			<col>journal_id</col>
		</index>
	</table>
	
	<!--
	  *
	  * TABLE email_templates_data
	  *
	  -->
	<table name="email_templates_data">
		<descr>Data for journal email templates.</descr>
		<field name="email_key" type="C2" size="30">
			<descr>Unique identifier for this email.</descr>
			<KEY/>
		</field>
		<field name="locale" type="C2" size="5">
			<KEY/>
			<DEFAULT value="en_US"/>
		</field>
		<field name="journal_id" type="I8">
			<KEY/>
			<NOTNULL/>
		</field>
		<field name="subject" type="C2" size="120">
			<NOTNULL/>
		</field>
		<field name="body" type="X"/>
	</table>
	
	<!--
	 *
	 * TABLE article_search_keyword_list
	 *
	 -->
	<table name="article_search_keyword_list">
		<descr>List of all keywords.</descr>
		<field name="keyword_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="keyword_text" type="C2" size="60">
			<NOTNULL/>
		</field>
	</table>
	
	<!--
	 *
	 * TABLE article_search_keyword_index
	 *
	 -->
	<table name="article_search_keyword_index">
		<descr>Maps article seach results.</descr>
		<field name="article_id" type="I8">
			<KEY/>
		</field>
		<field name="keyword_id" type="I8">
			<KEY/>
		</field>
		<field name="count" type="I4">
			<descr>Number of occurrences of this keyword in the associated item.</descr>
			<NOTNULL/>
			<DEFAULT value="1"/>
		</field>
		<field name="type" type="I4">
			<descr>Type of item. E.g., abstract, fulltext, etc.</descr>
			<KEY/>
			<NOTNULL/>
		</field>
		<field name="assoc_id" type="I8">
			<KEY/>
			<descr>Optional ID of an associated record (e.g., a file_id)</descr>
		</field>
	</table>
	
	<!--
	 *
	 * TABLE article_search_results
	 *
	 -->
	<table name="article_search_results">
		<descr>Cached article search results.</descr>
		<field name="results_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="session_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="search_data" type="X"/>
		<index name="article_search_results_session_id">
			<col>session_id</col>
		</index>
	</table>
	
	<!--
	 *
	 * TABLE oai_resumption_tokens
	 *
	 -->
	 <table name="oai_resumption_tokens">
		<descr>Resumption tokens for the OAI protocol interface.</descr>
		<field name="token" type="C2" size="32">
			<KEY/>
		</field>
		<field name="expire" type="I8">
			<NOTNULL/>
		</field>
		<field name="record_offset" type="I4">
			<NOTNULL/>
		</field>
		<field name="params" type="X" />
	 </table>

	<!--
	 *
	 * TABLE subscription_types 
	 *
	 -->
	<table name="subscription_types">
		<descr>Subscription types.</descr>
		<field name="type_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="journal_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="type_name" type="C" size="80">
			<NOTNULL/>
		</field>
		<field name="description" type="X">
		</field>
		<field name="cost" type="F">
			<NOTNULL/>
		</field>
		<field name="currency" type="I2">
			<NOTNULL/>
		</field>
		<field name="format" type="I2">
			<NOTNULL/>
		</field>
		<field name="institutional" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="membership" type="L">
			<NOTNULL/>
			<DEFAULT value="0"/>
		</field>
		<field name="seq" type="F">
			<NOTNULL/>
		</field>
		<index name="subscription_types_journal_id">
			<col>journal_id</col>
		</index>
		<index name="subscription_types_type_name">
			<col>type_name</col>
		</index>
	</table>

	<!--
	 *
	 * TABLE subscriptions
	 *
	 -->
	<table name="subscriptions">
		<descr>Journal subscriptions.</descr>
		<field name="subscription_id" type="I8">
			<KEY/>
			<AUTOINCREMENT/>
		</field>
		<field name="journal_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="user_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="type_id" type="I8">
			<NOTNULL/>
		</field>
		<field name="date_start" type="D">
			<NOTNULL/>
		</field>
		<field name="date_end" type="D">
			<NOTNULL/>
		</field>
		<field name="membership" type="C" size="40">
		</field>
		<field name="domain" type="C" size="255">
		</field>
		<field name="ip_range" type="C" size="255">
		</field>
		<index name="subscription_journal_id">
			<col>journal_id</col>
		</index>
		<index name="subscription_user_id">
			<col>user_id</col>
		</index>
		<index name="subscription_domain">
			<col>domain</col>
		</index>
		<index name="subscription_ip_range">
			<col>ip_range</col>
		</index>
	</table>

</schema>
